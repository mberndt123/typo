"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[7392],{9546:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var r=t(4848),s=t(8453);const o={title:"Streaming inserts with COPY API"},i=void 0,a={id:"other-features/streaming-inserts",title:"Streaming inserts with COPY API",description:"If you customize Typo with enableStreamingInserts = true,",source:"@site/docs/other-features/streaming-inserts.md",sourceDirName:"other-features",slug:"/other-features/streaming-inserts",permalink:"/typo/docs/other-features/streaming-inserts",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Streaming inserts with COPY API"},sidebar:"tutorialSidebar",previous:{title:"Testing with random values",permalink:"/typo/docs/other-features/testing-with-random-values"},next:{title:"Generate code into multiple projects",permalink:"/typo/docs/other-features/generate-into-multiple-projects"}},c={},d=[{value:"anorm",id:"anorm",level:3},{value:"doobie",id:"doobie",level:3},{value:"zio",id:"zio",level:3}];function l(e){const n={a:"a",code:"code",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["If you ",(0,r.jsx)(n.a,{href:"/typo/docs/customization/overview",children:"customize"})," Typo with ",(0,r.jsx)(n.code,{children:"enableStreamingInserts = true"}),",\nyou can use the ",(0,r.jsx)(n.code,{children:"insertStreaming"})," and ",(0,r.jsx)(n.code,{children:"insertStreamingUnsaved"})," method on your repositories to insert a stream of data\ninto the database."]}),"\n",(0,r.jsxs)(n.p,{children:["Under the covers this uses the ",(0,r.jsx)(n.a,{href:"https://www.postgresql.org/docs/current/sql-copy.html",children:"Copy API"})," in Postgres, which\nis SUPER FAST compared to other ways of inserting data!"]}),"\n",(0,r.jsxs)(n.p,{children:["NOTE: ",(0,r.jsx)(n.code,{children:"insertStreamingUnsaved"})," requires PostgreSQL 16 or later!"]}),"\n",(0,r.jsx)(n.p,{children:"The signatures varies for each database library, because there are different stream representations"}),"\n",(0,r.jsx)(n.h3,{id:"anorm",children:"anorm"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:"def insertStreaming(unsaved: Iterator[PersonRow], batchSize: Int)(implicit c: Connection): Long\n/* NOTE: this functionality requires PostgreSQL 16 or later! */\ndef insertUnsavedStreaming(unsaved: Iterator[PersonRowUnsaved], batchSize: Int)(implicit c: Connection): Long\n"})}),"\n",(0,r.jsx)(n.h3,{id:"doobie",children:"doobie"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:"def insertStreaming(unsaved: Stream[ConnectionIO, PersonRow], batchSize: Int): ConnectionIO[Long]\n/* NOTE: this functionality requires PostgreSQL 16 or later! */\ndef insertUnsavedStreaming(unsaved: Stream[ConnectionIO, PersonRowUnsaved], batchSize: Int): ConnectionIO[Long]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"zio",children:"zio"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-scala",children:"def insertStreaming(unsaved: ZStream[ZConnection, Throwable, PersonRow], batchSize: Int): ZIO[ZConnection, Throwable, Long]\n/* NOTE: this functionality requires PostgreSQL 16 or later! */\ndef insertUnsavedStreaming(unsaved: ZStream[ZConnection, Throwable, PersonRowUnsaved], batchSize: Int): ZIO[ZConnection, Throwable, Long]\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var r=t(6540);const s={},o=r.createContext(s);function i(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);