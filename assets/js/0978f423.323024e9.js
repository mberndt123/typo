"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[6140],{8199:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var o=n(4848),r=n(8453);const s={title:"SQL DSL"},i=void 0,a={id:"what-is/dsl",title:"SQL DSL",description:"The Typo SQL DSL, an optional yet strongly recommended SQL DSL, can be an invaluable addition to your Scala toolbox,",source:"@site/docs/what-is/dsl.md",sourceDirName:"what-is",slug:"/what-is/dsl",permalink:"/typo/docs/what-is/dsl",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"SQL DSL"},sidebar:"tutorialSidebar",previous:{title:"Generated code for relations",permalink:"/typo/docs/what-is/relations"},next:{title:"Getting started",permalink:"/typo/docs/setup"}},d={},l=[{value:"Select DSL",id:"select-dsl",level:2},{value:"Update DSL",id:"update-dsl",level:2},{value:"Delete DSL",id:"delete-dsl",level:2},{value:"Further reading",id:"further-reading",level:2},{value:"Example usage:",id:"example-usage",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"The Typo SQL DSL, an optional yet strongly recommended SQL DSL, can be an invaluable addition to your Scala toolbox,\noffering you a lot of convenience:"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Simplicity"}),":\nIt's simple. Both for the developer, and for the compiler!"]}),"\n",(0,o.jsx)(t.p,{children:"Neither aggregation nor projection is allowed \u2014 you always work on whole rows.\nOn the other hand, you get predicates, joins, ordering, pagination."}),"\n",(0,o.jsxs)(t.p,{children:['It\'s designed to cover the "I just need to fetch/update this data" scenario, without requiring you to break flow by creating an sql file.\nWhenever you need more flexibility, you should reach for ',(0,o.jsx)(t.a,{href:"/typo/docs/what-is/sql-is-king",children:"SQL files"})]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Type Safety"}),":\nWith the Typo DSL, you benefit from Scala's robust type system, ensuring that your queries are\nsyntactically correct at compile time.\nSay goodbye to runtime errors caused by mismatched column names or data types."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Readability and Maintainability"}),":\nThe Typo DSL promotes clean, expressive code, making it easier to understand and maintain your database queries.\nNo more wrestling with long, convoluted SQL strings scattered throughout your codebase."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"Tooling Integration"}),": Leverage the power of IDEs and code editors for autocomplete, refactoring, and error checking,\nas\nthe Typo DSL seamlessly integrates with IDEs. This significantly boosts developer productivity."]}),"\n",(0,o.jsx)(t.h2,{id:"select-dsl",children:"Select DSL"}),"\n",(0,o.jsx)(t.p,{children:"Some features"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Type-safe"}),"\n",(0,o.jsx)(t.li,{children:"Generates not-too-terrible SQL"}),"\n",(0,o.jsx)(t.li,{children:"Arbitrarily deep joins"}),"\n",(0,o.jsx)(t.li,{children:"Order by"}),"\n",(0,o.jsx)(t.li,{children:"Expresses a rich set of predicates (sql operators, functions, string functions, comparisons, etc)"}),"\n",(0,o.jsx)(t.li,{children:"Some functions defined for string and array types"}),"\n",(0,o.jsx)(t.li,{children:"Set of operators and functions are extendable by user"}),"\n",(0,o.jsxs)(t.li,{children:["Works both when backed by ",(0,o.jsx)(t.a,{href:"/typo/docs/other-features/testing-with-stubs",children:"in-memory stubs"})," and by PostgreSQL"]}),"\n"]}),"\n",(0,o.jsx)("video",{width:"100%",controls:!0,src:"https://user-images.githubusercontent.com/247937/257662719-2a295f48-7cd2-4c49-b043-90bc8511de67.mp4"}),"\n",(0,o.jsx)(t.h2,{id:"update-dsl",children:"Update DSL"}),"\n",(0,o.jsxs)(t.p,{children:["Can express batch updates, where you ",(0,o.jsx)(t.code,{children:"set"})," arbitrary number of columns with an arbitrary number of (implicitly ",(0,o.jsx)(t.code,{children:"AND"}),"ed)\npredicates."]}),"\n",(0,o.jsx)(t.p,{children:"Column values can be computed from the original value in the column or from the entire row, as seen below"}),"\n",(0,o.jsx)("video",{width:"100%",controls:!0,src:"https://user-images.githubusercontent.com/247937/257148737-7b32df2c-af54-4397-85d3-eab863179d78.mp4"}),"\n",(0,o.jsx)(t.h2,{id:"delete-dsl",children:"Delete DSL"}),"\n",(0,o.jsxs)(t.p,{children:["There is also a ",(0,o.jsx)(t.code,{children:"delete"})," DSL, similar to ",(0,o.jsx)(t.code,{children:"select"})," and ",(0,o.jsx)(t.code,{children:"update"}),". It has no video yet, unfortunately."]}),"\n",(0,o.jsx)(t.h2,{id:"further-reading",children:"Further reading"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"/typo/docs/setup",children:"Getting started"})," for some information about how to set up the DSL."]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"/typo/docs/limitations",children:"Limitations"})," for a caveat on how PostgreSQL infers nullability."]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"/typo/docs/customization/customize-sql-files",children:"Customize sql files"})," for how to override parameter/column names, types and nullability"]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"/typo/docs/patterns/dynamic-queries",children:"Dynamic queries"})," for how to introduce some amount of dynamism in your queries"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"example-usage",children:"Example usage:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-scala",children:'productRepo.select\n  .where(_.`class` === "H ")\n  .where(x => x.daystomanufacture > 25 or x.daystomanufacture <= 0)\n  .where(x => x.productline === "foo")\n  .join(unitmeasureRepo.select.where(_.name.like("name%")))\n  .on { case (p, um) => p.sizeunitmeasurecode === um.unitmeasurecode }\n  .join(projectModelRepo.select)\n  .leftOn { case ((product, _), productModel) => product.productmodelid === productModel.productmodelid }\n  .where { case ((product, _), productModel) => product.productmodelid === productModel(_.productmodelid) }\n  .orderBy { case ((product, _), _) => product.productmodelid.asc }\n  .orderBy { case ((_, _), productModel) => productModel(_.name).desc.withNullsFirst }\n  .toList\n// res1: List[Tuple2[Tuple2[ProductRow, UnitmeasureRow], Option[ProductmodelRow]]] = List(\n// )\n'})})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var o=n(6540);const r={},s=o.createContext(r);function i(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);