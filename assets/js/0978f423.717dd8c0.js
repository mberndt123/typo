"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[173],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>y});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=u(n),m=o,y=c["".concat(s,".").concat(m)]||c[m]||p[m]||r;return n?a.createElement(y,i(i({ref:t},d),{},{components:n})):a.createElement(y,i({ref:t},d))}));function y(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:o,i[1]=l;for(var u=2;u<r;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4224:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>u});var a=n(7462),o=(n(7294),n(3905));const r={title:"SQL DSL"},i=void 0,l={unversionedId:"what-is/dsl",id:"what-is/dsl",title:"SQL DSL",description:"In the world of data retrieval, there are countless instances where swift and precise data extraction is paramount.",source:"@site/docs/what-is/dsl.md",sourceDirName:"what-is",slug:"/what-is/dsl",permalink:"/typo/docs/what-is/dsl",draft:!1,tags:[],version:"current",frontMatter:{title:"SQL DSL"},sidebar:"tutorialSidebar",previous:{title:"Generated code for relations",permalink:"/typo/docs/what-is/relations"},next:{title:"Getting started",permalink:"/typo/docs/setup"}},s={},u=[{value:"Select DSL",id:"select-dsl",level:2},{value:"Update DSL",id:"update-dsl",level:2},{value:"Delete DSL",id:"delete-dsl",level:2},{value:"Further reading",id:"further-reading",level:2},{value:"Example usage:",id:"example-usage",level:2}],d={toc:u},c="wrapper";function p(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"In the world of data retrieval, there are countless instances where swift and precise data extraction is paramount.\nThis is where a DSL truly shines."),(0,o.kt)("p",null,"The Typo DSL, an optional yet strongly recommended SQL DSL, can be an invaluable addition to your Scala toolkit,\noffering you the convenience you need without imposing any constraints:"),(0,o.kt)("p",null,"Type Safety: With the Typo DSL, you benefit from Scala's robust type system, ensuring that your queries are\nsyntactically correct at compile time. Say goodbye to runtime errors caused by mismatched column names or data types."),(0,o.kt)("p",null,"Readability and Maintainability: The Typo DSL promotes clean, expressive code, making it easier to understand and\nmaintain your database queries. No more wrestling with long, convoluted SQL strings scattered throughout your codebase."),(0,o.kt)("p",null,"Tooling Integration: Leverage the power of IDEs and code editors for autocomplete, refactoring, and error checking, as\nthe Typo DSL seamlessly integrates with popular development tools. This significantly boosts developer productivity."),(0,o.kt)("p",null,"Community Support: Join a thriving community of developers who have embraced the Typo DSL, benefitting from shared\nknowledge, best practices, and community-contributed extensions."),(0,o.kt)("p",null,"Runtime Safety: While the Typo DSL is optional, it's designed to provide runtime support that can catch potential issues\nearly, giving you peace of mind when interacting with your PostgreSQL database."),(0,o.kt)("p",null,"In summary, the strongly typed DSL for PostgreSQL access in Scala, known as the Typo DSL, offers a compelling blend of\ntype safety, readability, and flexibility while maintaining the optionality you desire. It's time to embrace the\nconvenience and power of the Typo DSL for smoother, more efficient data retrieval in your projects."),(0,o.kt)("h2",{id:"select-dsl"},"Select DSL"),(0,o.kt)("p",null,"Some features"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"type-safe"),(0,o.kt)("li",{parentName:"ul"},"generates not-too-terrible SQL"),(0,o.kt)("li",{parentName:"ul"},"arbitrarily deep joins"),(0,o.kt)("li",{parentName:"ul"},"order by"),(0,o.kt)("li",{parentName:"ul"},"expresses a rich set of predicates (sql operators, functions, string functions, comparisons, etc)"),(0,o.kt)("li",{parentName:"ul"},"some functions defined for string and array types"),(0,o.kt)("li",{parentName:"ul"},"set of operators and functions are extendable by user"),(0,o.kt)("li",{parentName:"ul"},"works both when backed by ",(0,o.kt)("a",{parentName:"li",href:"/typo/docs/other-features/testing-with-stubs"},"in-memory stubs")," and by Postgres")),(0,o.kt)("video",{width:"100%",controls:!0,autoplay:"autoplay",src:"https://user-images.githubusercontent.com/247937/257662719-2a295f48-7cd2-4c49-b043-90bc8511de67.mp4"}),(0,o.kt)("h2",{id:"update-dsl"},"Update DSL"),(0,o.kt)("p",null,"Can express batch updates, where you ",(0,o.kt)("inlineCode",{parentName:"p"},"set")," arbitrary number of columns with an arbitrary number of (implicitly ",(0,o.kt)("inlineCode",{parentName:"p"},"AND"),"ed)\npredicates."),(0,o.kt)("p",null,"Column values can be computed from the original value in the column or from the entire row, as seen below"),(0,o.kt)("video",{width:"100%",controls:!0,autoplay:"autoplay",src:"https://user-images.githubusercontent.com/247937/257148737-7b32df2c-af54-4397-85d3-eab863179d78.mp4"}),(0,o.kt)("h2",{id:"delete-dsl"},"Delete DSL"),(0,o.kt)("p",null,"There is also a ",(0,o.kt)("inlineCode",{parentName:"p"},"delete")," DSL, similar to ",(0,o.kt)("inlineCode",{parentName:"p"},"select")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"update"),". It has no video yet, unfortunately."),(0,o.kt)("h2",{id:"further-reading"},"Further reading"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/typo/docs/setup"},"Getting started")," for some information about how to set up the DSL."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/typo/docs/limitations"},"limitations")," for a caveat on how postgres infers nullability. "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/typo/docs/customization/customize-sql-files"},"customize sql files")," for how to override parameter/column names, types and nullability"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/typo/docs/patterns/dynamic-queries"},"dynamic queries")," for how to introduce some amount of dynamism in your queries")),(0,o.kt)("h2",{id:"example-usage"},"Example usage:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},'productRepo.select\n  .where(_.`class` === "H ")\n  .where(x => x.daystomanufacture > 25 or x.daystomanufacture <= 0)\n  .where(x => x.productline === "foo")\n  .join(unitmeasureRepo.select.where(_.name.like("name%")))\n  .on { case (p, um) => p.sizeunitmeasurecode === um.unitmeasurecode }\n  .join(projectModelRepo.select)\n  .leftOn { case ((product, _), productModel) => product.productmodelid === productModel.productmodelid }\n  .where { case ((product, _), productModel) => product.productmodelid === productModel(_.productmodelid) }\n  .orderBy { case ((product, _), _) => product.productmodelid.asc }\n  .orderBy { case ((_, _), productModel) => productModel(_.name).desc.withNullsFirst }\n  .toList\n// res1: List[Tuple2[Tuple2[ProductRow, UnitmeasureRow], Option[ProductmodelRow]]] = List(\n//   (\n//     (\n//       ProductRow(\n//         productid = ProductId(value = 217),\n//         name = Name(value = "name"),\n//         productnumber = "productnumber",\n//         makeflag = Flag(value = true),\n//         finishedgoodsflag = Flag(value = true),\n//         color = Some(value = "color"),\n//         safetystocklevel = TypoShort(value = 16),\n//         reorderpoint = TypoShort(value = 18),\n//         standardcost = 20,\n//         listprice = 22,\n//         size = Some(value = "size"),\n//         sizeunitmeasurecode = Some(value = UnitmeasureId(value = "kgg")),\n//         weightunitmeasurecode = Some(value = UnitmeasureId(value = "kgg")),\n//         weight = Some(value = 1.00),\n//         daystomanufacture = 26,\n//         productline = Some(value = "T "),\n//         class = Some(value = "H "),\n//         style = Some(value = "W "),\n//         productsubcategoryid = Some(value = ProductsubcategoryId(value = 220)),\n//         productmodelid = Some(value = ProductmodelId(value = 271)),\n//         sellstartdate = TypoLocalDateTime(value = 2023-09-09T23:39:21.955051),\n//         sellenddate = Some(\n//           value = TypoLocalDateTime(value = 2023-09-18T23:39:21.955437)\n//         ),\n//         discontinueddate = Some(\n//           value = TypoLocalDateTime(value = 2023-12-17T23:39:21.955453)\n//         ),\n//         rowguid = TypoUUID(value = 951d526c-f854-486b-b789-18b333c1c4ef),\n//         modifieddate = TypoLocalDateTime(value = 2023-09-08T23:39:21.956909)\n//       ),\n//       UnitmeasureRow(\n//         unitmeasurecode = UnitmeasureId(value = "kgg"),\n//         name = Name(value = "name"),\n//         modifieddate = TypoLocalDateTime(value = 2023-09-08T23:39:21.678562)\n//       )\n//     ),\n//     Some(\n//       value = ProductmodelRow(\n//         productmodelid = ProductmodelId(value = 271),\n//         name = Name(value = "name"),\n//         catalogdescription = Some(value = TypoXml(value = "<xml/>")),\n//         instructions = Some(value = TypoXml(value = "<instructions/>")),\n//         rowguid = TypoUUID(value = 2c390c4c-4e90-11ee-b5b2-0242ac1f0002),\n//         modifieddate = TypoLocalDateTime(value = 2023-09-08T23:39:21.678562)\n//       )\n// ...\n')))}p.isMDXComponent=!0}}]);