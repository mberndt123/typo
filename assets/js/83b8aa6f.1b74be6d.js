"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[6760],{4551:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>i,toc:()=>l});var n=o(4848),a=o(8453);const r={title:"Testing with random values"},s=void 0,i={id:"other-features/testing-with-random-values",title:"Testing with random values",description:"This covers a lot of interesting ground, test-wise.",source:"@site/docs/other-features/testing-with-random-values.md",sourceDirName:"other-features",slug:"/other-features/testing-with-random-values",permalink:"/typo/docs/other-features/testing-with-random-values",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Testing with random values"},sidebar:"tutorialSidebar",previous:{title:"Testing with stubs",permalink:"/typo/docs/other-features/testing-with-stubs"},next:{title:"Streaming inserts with COPY API",permalink:"/typo/docs/other-features/streaming-inserts"}},d={},l=[{value:"Usage example",id:"usage-example",level:3},{value:"Comparison with scalacheck",id:"comparison-with-scalacheck",level:3}];function u(e){const t={code:"code",em:"em",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"This covers a lot of interesting ground, test-wise."}),"\n",(0,n.jsxs)(t.p,{children:["If you enable ",(0,n.jsx)(t.code,{children:"enableTestInserts"})," in ",(0,n.jsx)(t.code,{children:"typo.Options"})," you now get an ",(0,n.jsx)(t.code,{children:"TestInsert"})," class, with a method to insert a row for each table Typo knows about.\nAll values except ids, foreign keys and so on are ",(0,n.jsx)(t.em,{children:"randomly generated"}),", but you can override them with named parameters."]}),"\n",(0,n.jsx)(t.p,{children:"The idea is that you:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"can easily insert rows for testing"}),"\n",(0,n.jsxs)(t.li,{children:["can explicitly set the values you ",(0,n.jsx)(t.em,{children:"do"})," care about"]}),"\n",(0,n.jsx)(t.li,{children:"will get random values for the rest"}),"\n",(0,n.jsx)(t.li,{children:"are still forced to follow FKs to setup the data graph correctly"}),"\n",(0,n.jsx)(t.li,{children:"it's easy to follow those FKs, because after inserting a row you get the persisted version back, including generated IDs"}),"\n",(0,n.jsxs)(t.li,{children:["can get the same values each time by hard coding the seed ",(0,n.jsx)(t.code,{children:"new TestInsert(new scala.util.Random(0L))"}),", or you can run it multiple times with different seeds to see that the random values really do not matter"]}),"\n",(0,n.jsxs)(t.li,{children:["do not need to write ",(0,n.jsx)(t.em,{children:"any"})," code to get all this available to you, like the rest of Typo."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"In summary, this is a fantastic way of setting up complex test scenarios in the database!"}),"\n",(0,n.jsx)(t.h3,{id:"usage-example",children:"Usage example"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-scala",children:'import adventureworks.customtypes.{Defaulted, TypoXml}\nimport adventureworks.production.unitmeasure.UnitmeasureId\nimport adventureworks.TestInsert\n\nimport scala.util.Random\n\nval testInsert = new TestInsert(new Random(0))\n// testInsert: TestInsert = adventureworks.TestInsert@7485c18\n\nval unitmeasure = testInsert.productionUnitmeasure(UnitmeasureId("kgg"))\n// unitmeasure: UnitmeasureRow = UnitmeasureRow(\n//   unitmeasurecode = UnitmeasureId(value = "kgg"),\n//   name = Name(value = "CCzLNHBFHuRvbI1iI19W"),\n//   modifieddate = TypoLocalDateTime(value = 2024-06-04T00:42:19.664379)\n// )\nval productCategory = testInsert.productionProductcategory()\n// productCategory: ProductcategoryRow = ProductcategoryRow(\n//   productcategoryid = ProductcategoryId(value = 7),\n//   name = Name(value = "jGGR8UNWutFRZvWebpA5"),\n//   rowguid = TypoUUID(value = 8921d694-21fa-11ef-81c3-0242ac1b0002),\n//   modifieddate = TypoLocalDateTime(value = 2024-06-04T00:42:19.664379)\n// )\nval productSubcategory = testInsert.productionProductsubcategory(productCategory.productcategoryid)\n// productSubcategory: ProductsubcategoryRow = ProductsubcategoryRow(\n//   productsubcategoryid = ProductsubcategoryId(value = 7),\n//   productcategoryid = ProductcategoryId(value = 7),\n//   name = Name(value = "WHfyqts0coJXQqPyuxbr"),\n//   rowguid = TypoUUID(value = 892638f6-21fa-11ef-81c3-0242ac1b0002),\n//   modifieddate = TypoLocalDateTime(value = 2024-06-04T00:42:19.664379)\n// )\nval productModel = testInsert.productionProductmodel(catalogdescription = Some(new TypoXml("<xml/>")), instructions = Some(new TypoXml("<instructions/>")))\n// productModel: ProductmodelRow = ProductmodelRow(\n//   productmodelid = ProductmodelId(value = 7),\n//   name = Name(value = "589wyJzS2SuiHrAOB2Ru"),\n//   catalogdescription = Some(value = TypoXml(value = "<xml/>")),\n//   instructions = Some(value = TypoXml(value = "<instructions/>")),\n//   rowguid = TypoUUID(value = 892b5ae8-21fa-11ef-81c3-0242ac1b0002),\n//   modifieddate = TypoLocalDateTime(value = 2024-06-04T00:42:19.664379)\n// )\ntestInsert.productionProduct(\n  sizeunitmeasurecode = Some(unitmeasure.unitmeasurecode),\n  weightunitmeasurecode = Some(unitmeasure.unitmeasurecode),\n  `class` = Some("H "),\n  style = Some("W "),\n  productsubcategoryid = Some(productSubcategory.productsubcategoryid),\n  productmodelid = Some(productModel.productmodelid)\n)\n// res1: ProductRow = ProductRow(\n//   productid = ProductId(value = 7),\n//   name = Name(value = "vBbFbQPNB7ZuKSWpBejT"),\n//   productnumber = "wv1NdpH7sjiP63hvGdgZ",\n//   makeflag = Flag(value = true),\n//   finishedgoodsflag = Flag(value = true),\n//   color = None,\n//   safetystocklevel = TypoShort(value = 21170),\n//   reorderpoint = TypoShort(value = 27774),\n//   standardcost = 0.9043197434746348,\n//   listprice = 0.2871518999993117,\n//   size = None,\n//   sizeunitmeasurecode = Some(value = UnitmeasureId(value = "kgg")),\n//   weightunitmeasurecode = Some(value = UnitmeasureId(value = "kgg")),\n//   weight = Some(value = 0.32),\n//   daystomanufacture = 412901507,\n//   productline = None,\n//   class = Some(value = "H "),\n//   style = Some(value = "W "),\n//   productsubcategoryid = Some(value = ProductsubcategoryId(value = 7)),\n//   productmodelid = Some(value = ProductmodelId(value = 7)),\n//   sellstartdate = TypoLocalDateTime(value = 2003-07-12T04:09:01),\n//   sellenddate = None,\n//   discontinueddate = None,\n//   rowguid = TypoUUID(value = 893078fc-21fa-11ef-81c3-0242ac1b0002),\n//   modifieddate = TypoLocalDateTime(value = 2024-06-04T00:42:19.664379)\n// )\n'})}),"\n",(0,n.jsx)(t.h3,{id:"comparison-with-scalacheck",children:"Comparison with scalacheck"}),"\n",(0,n.jsx)(t.p,{children:"This does look a lot like scalacheck indeed."}),"\n",(0,n.jsx)(t.p,{children:"But look closer, there are:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"no implicits"}),"\n",(0,n.jsx)(t.li,{children:"no integration glue code with test libraries"}),"\n",(0,n.jsx)(t.li,{children:"almost no imports, you need to mention very few types"}),"\n",(0,n.jsx)(t.li,{children:"no keeping track of all the possible row types and repositories"}),"\n",(0,n.jsx)(t.li,{children:"and so on"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"This feature is meant to be easy to use, and I really think/hope it is!"})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},8453:(e,t,o)=>{o.d(t,{R:()=>s,x:()=>i});var n=o(6540);const a={},r=n.createContext(a);function s(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);